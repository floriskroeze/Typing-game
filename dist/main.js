var s=(t=>(t.START="start-screen",t.SETTINGS="settings",t.GAMEBOARD="gameboard",t.END="end-screen",t))(s||{});const c=t=>(document==null?void 0:document.getElementById(t))??null,l=t=>{var e;(e=c(t))==null||e.classList.remove("hidden")},T=t=>{var e;(e=c(t))==null||e.classList.add("hidden")};class E{constructor(e=null,r=0,n=0,i=0){this._currentLetter=e,this._mistakeCount=r,this._gameTime=n,this._totalCharactersTyped=i}get currentLetter(){return this._currentLetter}set currentLetter(e){this._currentLetter=e}get mistakeCount(){return this._mistakeCount}set mistakeCount(e){this._mistakeCount=e}get gameTime(){return this._gameTime}set gameTime(e){this._gameTime=e}get totalCharactersTyped(){return this._totalCharactersTyped}set totalCharactersTyped(e){this._totalCharactersTyped=e}static getInstance(){return this.instance?this.instance:new this("",0,0,0)}}class f{constructor(e){this.time=0,this.observers=[],this.time=e,this.notifyObservers()}start(){const e=setInterval(()=>{this.time--,this.notifyObservers(),this.time===0&&clearInterval(e)},1e3)}stop(){this.time=0}getTimeString(){return this.time.toString()}registerObserver(e){this.observers.push(e)}unregisterObserver(e){this.observers=this.observers.filter(r=>r!==e)}notifyObservers(){this.observers.forEach(e=>e.update(this.time.toString()))}}async function S(t){console.log("Selecting game text with difficulty: "+t);const e=await p(),r=v(e.gameTexts,t),n=I(r);return a.getInstance().setGameText(n),y(n.text)}const p=async()=>fetch("src/data.json").then(t=>{if(!t.ok)throw new Error("Could not fetch game text.");return t.json()}),v=(t,e)=>t==null?void 0:t.filter(r=>r.difficulty===e),I=t=>t[Math.floor(Math.random()*t.length)],y=t=>M(t.split(" ")),M=t=>t.flatMap(e=>[e," "]);function w(t){t.forEach((e,r)=>{var d;const n=(d=c(s.GAMEBOARD))==null?void 0:d.querySelector(".words-wrapper"),i=L();r===0&&i.classList.add("active"),e.split("").forEach(g=>i.appendChild(b(g))),n==null||n.appendChild(i)})}const L=()=>{const t=document.createElement("div");return t.classList.add("word"),t},b=t=>{const e=document.createElement("letter");return e.classList.add("letter"),e.innerText=t,e};function A(){document.body.addEventListener("click",t=>{t.preventDefault(),document.body.focus()}),document==null||document.body.addEventListener("keydown",C)}const C=t=>{t.preventDefault(),t.key};function x(t){if(!c(s.GAMEBOARD))throw new Error("Gameboard not found.");console.log("Initialising gameboard with settings: Difficulty: "+t+"."),S(t).then(e=>{w(e),l(s.GAMEBOARD),console.log(a.getInstance().getGameText().text)}),A(),console.log("Gameboard initialised.")}const o=class o{constructor(e){this.subject=e,o.setInnerHTML(e.getTimeString()),e.registerObserver(this)}static getClockElement(){return document.getElementById(this.ELEMENT_ID)}static setInnerHTML(e){const r=o.getClockElement();r&&(r.innerHTML=e)}update(e){console.log("ClockDisplay: update"),o.setInnerHTML(e)}};o.ELEMENT_ID="clock";let u=o;class a{constructor(e){this.clock=new f(e.gameLength),this.gameState=new E,this.gameText={text:"",difficulty:1}}setGameText(e){this.gameText=e}getGameText(){return this.gameText}startRound(){this.clock.start()}endRound(){}resetRound(){}static getInstance(){return this.instance}static init(e){this.instance=new a(e),new u(this.instance.clock),x(e.difficulty),console.log("GameRound initialized")}}var m=(t=>(t[t.EASY=1]="EASY",t[t.MEDIUM=2]="MEDIUM",t[t.HARD=3]="HARD",t))(m||{}),h=(t=>(t[t.TEN_SECONDS=10]="TEN_SECONDS",t[t.HALF_MINUTE=30]="HALF_MINUTE",t[t.ONE_MINUTE=60]="ONE_MINUTE",t[t.TWO_MINUTES=120]="TWO_MINUTES",t))(h||{});function D(){if(!c(s.START))throw new Error("Start screen not found.");O(),l(s.START)}const O=()=>{var e;const t=(e=c(s.START))==null?void 0:e.querySelector("form");if(!t)throw new Error("Start form not found.");t.addEventListener("submit",r=>{r.preventDefault();const n=R(r.currentTarget),i={difficulty:m[n.difficulty],gameLength:h[n.gameLength]};a.init(i),a.getInstance().startRound(),T(s.START)})},R=t=>{const e=new FormData(t);return{difficulty:e.get("difficulty"),gameLength:e.get("gameLength")}};D();
