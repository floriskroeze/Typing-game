class n{constructor(){this.time=0,this.observers=[],this.intervalId=null}setTime(t){this.time=t,this.notifyObservers(this.getTimeString())}start(){this.intervalId===null&&(this.intervalId=window.setInterval(()=>{this.time>0?(this.time--,this.notifyObservers(this.getTimeString())):this.stop()},1e3))}stop(){this.intervalId!==null&&(clearInterval(this.intervalId),this.intervalId=null)}getTimeString(){return this.time.toString()}isRunning(){return this.intervalId!==null}registerObserver(t){this.observers.push(t)}unregisterObserver(t){this.observers=this.observers.filter(s=>s!==t)}notifyObservers(t){this.observers.forEach(s=>s.update(this.time.toString()))}static getInstance(){return n.instance||(n.instance=new n),n.instance}}var h=(e=>(e[e.START=0]="START",e[e.PLAYING=1]="PLAYING",e[e.FINISHED=2]="FINISHED",e))(h||{});const g={EASY:1,MEDIUM:2,HARD:3},d={TEN_SECONDS:10,HALF_MINUTE:30,ONE_MINUTE:60,TWO_MINUTES:120},m=e=>new FormData(e);class v{constructor(){this.element=document.getElementById("clock"),this.subject=n.getInstance(),this.subject.registerObserver(this)}setInnerHTML(t){this.element.innerHTML=t}update(t){this.setInnerHTML(t)}static getInstance(){return this.instance||(this.instance=new this),this.instance}}const c=e=>document==null?void 0:document.getElementById(e);var a=(e=>(e.START="start-screen",e.GAMEBOARD="gameboard",e.END="end-screen",e))(a||{});class o{constructor(){this.currentState=h.START,this.screens={start:c(a.START),game:c(a.GAMEBOARD),end:c(a.END)}}getScreen(t){return this.screens[t]}setCurrentState(t){this.currentState=t}showScreen(t){Object.values(this.screens).forEach(s=>s.classList.add("hidden")),this.screens[t].classList.remove("hidden")}static getInstance(){return this.instance||(this.instance=new this),this.instance}}class i{constructor(){this.pressedKey="",this.observers=[],this.keyDownHandler=this.handleKeydown.bind(this)}setPressedKey(t){this.pressedKey=t,this.notifyObservers()}getPressedKey(){return this.pressedKey}registerObserver(t){this.observers.push(t)}unregisterObserver(t){this.observers=this.observers.filter(s=>s!==t)}notifyObservers(){this.observers.forEach(t=>t.update(this.pressedKey))}registerToDocument(){document.addEventListener("keydown",this.handleKeydown.bind(this))}unregisterFromDocument(){document.removeEventListener("keydown",this.handleKeydown.bind(this))}static getInstance(){return i.instance||(i.instance=new i),i.instance}handleKeydown(t){const s=t.key;["Shift","Control","Alt","Meta"].includes(s)||(n.getInstance().isRunning()||n.getInstance().start(),this.setPressedKey(t.key))}}class I{constructor(){this.setupGame=t=>{t.preventDefault();const s=o.getInstance();s.setCurrentState(h.PLAYING);const r=m(t.currentTarget),u=r.get("gameLength"),l=r.get("difficulty");this.initClock(d[u]),this.initGameBoard(g[l]),i.getInstance().registerToDocument(),s.showScreen("game")},this.initGlobalEventListeners()}initGlobalEventListeners(){o.getInstance().getScreen("start").querySelector("form").addEventListener("submit",this.setupGame)}initClock(t){const s=n.getInstance();s.stop(),s.setTime(t),v.getInstance().setInnerHTML(s.getTimeString())}initGameBoard(t){}}class T{constructor(t=0,s=0,r=0){this._mistakeCount=t,this._gameTime=s,this._totalCharactersTyped=r}get mistakeCount(){return this._mistakeCount}set mistakeCount(t){this._mistakeCount=t}get gameTime(){return this._gameTime}set gameTime(t){this._gameTime=t}get totalCharactersTyped(){return this._totalCharactersTyped}set totalCharactersTyped(t){this._totalCharactersTyped=t}static getInstance(){return this.instance||(this.instance=new this("",0,0,0)),this.instance}}class y{constructor(){this.UI=new I,this.clock=n.getInstance(),this.state=T.getInstance()}static getInstance(){return this.instance||(this.instance=new this),this.instance}}y.getInstance();
