var s=(t=>(t.START="start",t.PLAYING="game",t.FINISHED="end",t))(s||{});const o=t=>document==null?void 0:document.getElementById(t);class g{constructor(e){if(this.DIFFICULTY_DEFAULT="easy",this.GAME_LENGTH_DEFAULT=10,this.onStartRequested=e,this.container=o(s.START),this.difficultyInputs=document.querySelectorAll("input[name=difficulty-select]"),this.gameLengthInputs=document.querySelectorAll("input[name=gameLength-select]"),this.startButton=document.getElementById("start-button"),!this.container||!this.startButton)throw new Error("StartScreen: Required DOM elements not found");this.startButton.addEventListener("click",this.handleStartClick.bind(this))}reset(){Array.from(this.difficultyInputs).forEach(e=>e.checked=e.value===this.DIFFICULTY_DEFAULT),Array.from(this.gameLengthInputs).forEach(e=>e.checked=parseInt(e.value)===this.GAME_LENGTH_DEFAULT)}handleStartClick(e){e.preventDefault();const r={difficulty:this.getSelectedDifficulty(),gameLength:this.getSelectedGameLength()};this.onStartRequested(r)}getSelectedDifficulty(){var e;return((e=Array.from(this.difficultyInputs).find(r=>r.checked))==null?void 0:e.value)??"easy"}getSelectedGameLength(){var e;return parseInt(((e=Array.from(this.gameLengthInputs).find(r=>r.checked))==null?void 0:e.value)??"10",10)}}var c=(t=>(t.START="start",t.PLAYING="playing",t.END="end",t))(c||{});class E{constructor(e,r,i,d,l,u){this.startScreen=new g(m=>{this.config=m,this.startGame()}),this.gameScreen=r,this.endScreen=i,this.timer=d,this.inputHandler=l,this.gameTextProvider=u,this.currentState=e,this.enterState(e)}enterState(e){this.exitCurrentState(),this.currentState=e,this.enterCurrentState()}exitCurrentState(){switch(this.currentState){case"start":this.handleStartExit();break;case"playing":this.handlePlayingExit();break;case"end":this.handleEndExit();break}}enterCurrentState(){switch(this.currentState){case"start":this.handleStartEnter();break;case"playing":this.handlePlayingEnter();break;case"end":this.handleEndEnter();break}}handleStartEnter(){console.log("Method not implemented.")}handlePlayingEnter(){}handleEndEnter(){throw new Error("Method not implemented.")}handleStartExit(){console.log(this.startScreen),this.startScreen.reset()}handlePlayingExit(){throw new Error("Method not implemented.")}handleEndExit(){throw new Error("Method not implemented.")}startGame(){this.enterState("playing")}endGame(){this.enterState("end")}resetGame(){throw new Error("Method not implemented.")}}class I{get(){throw new Error("Method not implemented.")}}class y{constructor(e){this.currentIndex=-1,this.gameText=[],this.gameText=e}getCurrentIndex(){return this.currentIndex}current(){return this.gameText[this.currentIndex]}hasNext(){return this.currentIndex<this.gameText.length}hasPrev(){return this.currentIndex!==0}next(){return this.currentIndex++,this.gameText[this.currentIndex]}prev(){return this.hasPrev()?(this.currentIndex--,this.gameText[this.currentIndex]):null}reset(){}}const S="letter",x=()=>document.querySelectorAll(S),h=t=>x()[t],T=(t,e)=>e?h(t).classList.add("correct"):h(t).classList.add("incorrect");class a{constructor(){this.time=0,this.observers=[],this.intervalId=null}setTime(e){this.time=e,this.notifyObservers(this.getTimeString())}start(){this.intervalId===null&&(this.intervalId=window.setInterval(()=>{this.time>0?(this.time--,this.notifyObservers(this.getTimeString())):this.stop()},1e3))}stop(){this.intervalId!==null&&(clearInterval(this.intervalId),this.intervalId=null)}getTimeString(){return this.time.toString()}isRunning(){return this.intervalId!==null}registerObserver(e){this.observers.push(e)}unregisterObserver(e){this.observers=this.observers.filter(r=>r!==e)}notifyObservers(e){this.observers.forEach(r=>r.update(this.time.toString()))}}class n{constructor(){this.pressedKey="",this.observers=[],this.keyDownHandler=this.handleKeydown.bind(this)}setPressedKey(e){this.pressedKey=e,this.notifyObservers()}getPressedKey(){return this.pressedKey}registerObserver(e){this.observers.push(e)}unregisterObserver(e){this.observers=this.observers.filter(r=>r!==e)}notifyObservers(){this.observers.forEach(e=>e.update(this.pressedKey))}registerToDocument(){document.addEventListener("keydown",this.keyDownHandler.bind(this))}unregisterFromDocument(){document.removeEventListener("keydown",this.keyDownHandler.bind(this))}static getInstance(){return n.instance||(n.instance=new n),n.instance}handleKeydown(e){const r=e.key;["Shift","Control","Alt","Meta"].includes(r)||(a.getInstance().isRunning()||a.getInstance().start(),this.setPressedKey(e.key))}}class v{constructor(){this.gameTextIterator=new y([]),n.getInstance().registerObserver(this)}isCorrect(e,r){return e===r}update(e){const r=this.gameTextIterator.next(),i=this.gameTextIterator.getCurrentIndex();T(i,this.isCorrect(e,r))}setGameTextIterator(e){this.gameTextIterator=e}static getInstance(){return this.instance||(this.instance=new this),this.instance}}class f{constructor(){this.container=document.getElementById(s.FINISHED)}init(){throw new Error("Method not implemented.")}}class p{constructor(e,r){this.onTextReady=e,this.container=o(s.PLAYING),this.timerElement=document.getElementById("timer"),this.textContainer=document.getElementById("text-container")}renderText(e){this.textContainer.innerHTML=e.text}updateCurrentLetter(e){this.textContainer.innerHTML=this.textContainer.innerHTML.replace(e,`<span>${e}</span>`)}markLetterCorrect(){}markLetterIncorrect(){}reset(){this.textContainer.innerHTML="",this.timerElement.innerHTML="00:00"}}const L=c.START,w=new p,b=new f,k=new a,A=v.getInstance(),C=new I;new E(L,w,b,k,A,C);
