var d=(e=>(e.START="start",e.PLAYING="playing",e.END="end",e))(d||{});class f{constructor(t,r,n,a,u,m,g){this.startScreen=r,this.gameScreen=n,this.endScreen=a,this.timer=u,this.inputHandler=m,this.gameTextProvider=g,this.currentState=t,this.enterState(t)}enterState(t){this.exitCurrentState(),this.currentState=t,this.enterCurrentState()}exitCurrentState(){switch(this.currentState){case"start":this.handleStartExit();break;case"playing":this.handlePlayingExit();break;case"end":this.handleEndExit();break}}enterCurrentState(){switch(this.currentState){case"start":this.handleStartEnter();break;case"playing":this.handlePlayingEnter();break;case"end":this.handleEndEnter();break}}handleStartEnter(){console.log("Method not implemented.")}handlePlayingEnter(){}handleEndEnter(){throw new Error("Method not implemented.")}handleStartExit(){console.log(this.startScreen),this.startScreen.reset()}handlePlayingExit(){throw new Error("Method not implemented.")}handleEndExit(){throw new Error("Method not implemented.")}startGame(){this.enterState("playing")}endGame(){this.enterState("end")}resetGame(){throw new Error("Method not implemented.")}}const y=[{text:"the quick brown fox jumps over the lazy dog",difficulty:0},{text:"pack my box with five dozen liquor jugs",difficulty:0},{text:"sphinx of black quartz judge my vow",difficulty:1},{text:"how vexingly quick daft zebras jump",difficulty:1},{text:"the five boxing wizards jump quickly",difficulty:2}];class E{getText(t){const r=y.filter(a=>a.difficulty===t.difficulty);if(r.length===0)return"No texts with difficulty found";const n=Math.floor(Math.random()*r.length);return r[n].text}}class x{constructor(t){this.currentIndex=-1,this.gameText=[],this.gameText=t}getCurrentIndex(){return this.currentIndex}current(){return this.gameText[this.currentIndex]}hasNext(){return this.currentIndex<this.gameText.length}hasPrev(){return this.currentIndex!==0}next(){return this.currentIndex++,this.gameText[this.currentIndex]}prev(){return this.hasPrev()?(this.currentIndex--,this.gameText[this.currentIndex]):null}reset(){}}const I="letter",v=()=>document.querySelectorAll(I),o=e=>v()[e],T=(e,t)=>t?o(e).classList.add("correct"):o(e).classList.add("incorrect");class h{constructor(){this.time=0,this.observers=[],this.intervalId=null}setTime(t){this.time=t,this.notifyObservers(this.getTimeString())}start(){this.intervalId===null&&(this.intervalId=window.setInterval(()=>{this.time>0?(this.time--,this.notifyObservers(this.getTimeString())):this.stop()},1e3))}stop(){this.intervalId!==null&&(clearInterval(this.intervalId),this.intervalId=null)}getTimeString(){return this.time.toString()}isRunning(){return this.intervalId!==null}registerObserver(t){this.observers.push(t)}unregisterObserver(t){this.observers=this.observers.filter(r=>r!==t)}notifyObservers(t){this.observers.forEach(r=>r.update(this.time.toString()))}}class s{constructor(){this.pressedKey="",this.observers=[],this.keyDownHandler=this.handleKeydown.bind(this)}setPressedKey(t){this.pressedKey=t,this.notifyObservers()}getPressedKey(){return this.pressedKey}registerObserver(t){this.observers.push(t)}unregisterObserver(t){this.observers=this.observers.filter(r=>r!==t)}notifyObservers(){this.observers.forEach(t=>t.update(this.pressedKey))}registerToDocument(){document.addEventListener("keydown",this.keyDownHandler.bind(this))}unregisterFromDocument(){document.removeEventListener("keydown",this.keyDownHandler.bind(this))}static getInstance(){return s.instance||(s.instance=new s),s.instance}handleKeydown(t){const r=t.key;["Shift","Control","Alt","Meta"].includes(r)||(h.getInstance().isRunning()||h.getInstance().start(),this.setPressedKey(t.key))}}class S{constructor(){this.gameTextIterator=new x([]),s.getInstance().registerObserver(this)}isCorrect(t,r){return t===r}update(t){const r=this.gameTextIterator.next(),n=this.gameTextIterator.getCurrentIndex();T(n,this.isCorrect(t,r))}setGameTextIterator(t){this.gameTextIterator=t}static getInstance(){return this.instance||(this.instance=new this),this.instance}}var i=(e=>(e.START="start",e.PLAYING="game",e.FINISHED="end",e))(i||{});class p{constructor(){this.container=document.getElementById(i.FINISHED)}init(){throw new Error("Method not implemented.")}}const l=e=>document==null?void 0:document.getElementById(e);class L{constructor(){this.container=l(i.PLAYING),this.timerElement=document.getElementById("timer"),this.textContainer=document.getElementById("text-container")}renderText(t){this.textContainer.innerHTML=t.text}updateCurrentLetter(t){this.textContainer.innerHTML=this.textContainer.innerHTML.replace(t,`<span>${t}</span>`)}markLetterCorrect(){}markLetterIncorrect(){}reset(){this.textContainer.innerHTML="",this.timerElement.innerHTML="00:00"}}class w{constructor(t){if(this.DIFFICULTY_DEFAULT="easy",this.GAME_LENGTH_DEFAULT=10,this.onStartRequested=t,this.container=l(i.START),this.difficultyInputs=document.querySelectorAll("input[name=difficulty-select]"),this.gameLengthInputs=document.querySelectorAll("input[name=gameLength-select]"),this.startButton=document.getElementById("start-button"),!this.container||!this.startButton)throw new Error("StartScreen: Required DOM elements not found");this.startButton.addEventListener("click",this.handleStartClick.bind(this))}reset(){Array.from(this.difficultyInputs).forEach(t=>t.checked=t.value===this.DIFFICULTY_DEFAULT),Array.from(this.gameLengthInputs).forEach(t=>t.checked=parseInt(t.value)===this.GAME_LENGTH_DEFAULT)}handleStartClick(t){t.preventDefault();const r={difficulty:this.getSelectedDifficulty(),gameLength:this.getSelectedGameLength()};this.onStartRequested(r)}getSelectedDifficulty(){var t;return((t=Array.from(this.difficultyInputs).find(r=>r.checked))==null?void 0:t.value)??this.DIFFICULTY_DEFAULT}getSelectedGameLength(){var r;const t=(r=Array.from(this.gameLengthInputs).find(n=>n.checked))==null?void 0:r.value;return t?parseInt(t):this.GAME_LENGTH_DEFAULT}}const c=new f(d.START,new w(e=>{c.config=e,c.startGame()}),new L,new p,new h,S.getInstance(),new E);
